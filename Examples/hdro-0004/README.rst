.. _hydro-0004:

Coupled Digital Twin Example - Oregon State University Large Wave Flume Coupled Simulation (Concrete Core Wall Structure, Breaking Wave)

============================

\subsection{Numerical Investigation With Computational Fluid Dynamics}

The following section investigates the efficacy of CFD in simulating wave-structure interaction and hydrodynamics from paddle-generated breaking solitary waves and resolving experimental forces for integrated study of fluid behavior using a model at 1:1 scale with the experiments.

\subsubsection{Model Description} \label{sec:Model Description}

Model dimensions can be seen in Fig. \ref{fig:Model Dimensions}. Atmospheric boundary conditions for variables U (velocity) and p$_{rgh}$ (dynamic pressure) were applied to the topmost boundary of the model. All walls except the atmosphere boundary were assigned standard wall boundary conditions for the simulation. Specific boundary condition types for the turbulence model and dynamic mesh library were applied to necessary regions of the model for initialization of mesh movement and satisfaction of the requirements for numerical stability. Waves were generated by a pneumatically-powered piston at one end of the wave flume, which then propagated down the length of the flume to a sloped bathymetry, forcing the waves to initially spill and then fully break, which results in a turbulent bore prior to the flow reaching the test structure. \\

\indent  In order to replicate the experimental wave motion and measured fluid loads imparted on the structure, the displacement of the paddle during experiments was recorded as a time history. This paddle displacement history was imposed on the wavemaker paddle surface in the OpenFOAM model using the olaFlow boundary condition function wavemakerMovement to specify the mesh motion. More specifically, mesh-morphing wave generation boundary conditions were used to mimic the piston-driven paddle wavemaker at the Hinsdale Wave Research Lab by prescribing the variable 'pointDisplacement' within OpenFOAM. All boundary conditions applied in the models are listed in Table \ref{tab:BC Field Variables}. For further information and a comprehensive evaluation of OpenFOAM boundary conditions used in Large Wave Flume Models such as those utilized in this study, see \cite{Winter:2020}. 

The k-$\omega$ Shear Stress Transport ($k$-$\omega$ SST) model was utilized for the modelling of turbulence. The ($k$-$\omega$ SST) model, described by \cite{Menter:2003}, models turbulent kinetic energy, $k$, turbulent kinetic energy dissipation rate within the boundary region, $\omega$, and turbulence viscosity, ${\nu}_t$. This turbulence model formulation captures the turbulent kinetic energy generation in the near field of the wall much better than k-$\epsilon$ models, resulting in higher fidelity of shear stresses and forces imparted upon objects or structures within the flow. $\epsilon$ in these equations represents rate of dissipation of turbulent kinetic energy further away from the boundary. The $k$-$\omega$ SST model is essentially an extension of k-$\epsilon$ models, with almost identical behavior of the $k$-$\omega$ SST model and k-$\epsilon$ models far away from boundaries; however, the authors found slightly better results for viscous shear are generated near structures with the $k$-$\omega$ SST model. The turbulence model was initialized with the following values for turbulence coefficients: k ($9.54E$-$3$), $\epsilon$ ($4.45E$-$4$), $C_\mu$ ($0.90E$-$1$), and $\omega$ ($0.52$).

.. figure:: figures/Capture23.PNG
   :align: center
   :width: 600
   :figclass: align-center

.. figure:: figures/Capture22.PNG
   :align: center
   :width: 600
   :figclass: align-center

.. figure:: figures/Capture21.PNG
   :align: center
   :width: 600
   :figclass: align-center

.. figure:: figures/Capture20.PNG
   :align: center
   :width: 600
   :figclass: align-center

.. figure:: figures/Capture19.PNG
   :align: center
   :width: 600
   :figclass: align-center

.. figure:: figures/Capture18.PNG
   :align: center
   :width: 600
   :figclass: align-center

.. figure:: figures/Capture17.PNG
   :align: center
   :width: 600
   :figclass: align-center

.. figure:: figures/Capture16.PNG
   :align: center
   :width: 600
   :figclass: align-center

.. figure:: figures/Capture15.PNG
   :align: center
   :width: 600
   :figclass: align-center

.. figure:: figures/Capture14.PNG
   :align: center
   :width: 600
   :figclass: align-center

.. figure:: figures/Capture13.PNG
   :align: center
   :width: 600
   :figclass: align-center

.. figure:: figures/Capture12.PNG
   :align: center
   :width: 600
   :figclass: align-center

.. figure:: figures/Capture11.PNG
   :align: center
   :width: 600
   :figclass: align-center

.. figure:: figures/Capture9.PNG
   :align: center
   :width: 600
   :figclass: align-center

.. figure:: figures/Capture8.PNG
   :align: center
   :width: 600
   :figclass: align-center

.. figure:: figures/Capture7.PNG
   :align: center
   :width: 600
   :figclass: align-center

.. figure:: figures/Capture6.PNG
   :align: center
   :width: 600
   :figclass: align-center



\begin{table}[!h]
\small 
\caption{CFD Model Boundary Conditions for All Field Variables}      \label{tab:BC Field Variables}
  \begin{tabular}{|c||c|c|c|}
  \hline

Field & Atmosphere & Walls & Wavemaker \\
\hline
  \hline
U & pressureInletOutletVelocity & noSlip & movingWallVelocity \\

  \hline
p_{rgh} &	totalPressure &	fixedFluxPressure & fixedFluxPressure \\
\hline
\nu_t &	calculated & nutkWallFunction & nutkWallFunction \\
\hline
k &	inletOutlet & kqRWallFunction & kqRWallFunction \\
\hline
\omega & inletOutlet & omegaWallFunction & omegaWallFunction \\ 
\hline
\epsilon & inletOutlet & epsilonWallFuction & epsilonWallFuction \\
\hline
\alpha & inletOutlet & zeroGradient & zeroGradient \\
\hline
pointDisplacement & fixedNormalSlip/fixedValue & fixedNormalSlip/fixedValue & wavemakerMovement \\
\hline
  \end{tabular}

\end{table}

The computational domain was comprised of 3.2 million points and 3 million cells, with cell sizes varying from 10 cm$\times$10 cm$\times$10 cm far from the structure to 1.5 cm$\times$1.5 cm$\times$1.5 cm near the structure. CFD model time discretization was initialized with a 1E-4 maximum and 1E-9 minimum time step, with time step size governed by a Courant-Friedrichs-Lewy (CFL) condition of 0.5. Models were run on UW Hyak Klone with 40 processors, with 128G of memory per processor, and took approximately 20 hours to complete. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{Hydrodynamics Comparison and CFD Computational Results for Velocity and Free Surface}

\begin{figure}[!htb]

\centering
 \includegraphics[width=\linewidth]{ExperimentalTestCases/Figure 11.pdf}
 \centering
 \caption{Side Elevation of OpenFOAM Model at Selected Times}\label{fig:0swave}
\hfill

\end{figure}
 
The simulated results for wave movement, pressure distribution over the specimen, and structural forces were compared against the measured responses to evaluate the accuracy of the model. Fig. \ref{fig:0swave} shows elevation views of the simulated wave at various points of travel down the flume, as well as the end state (fully-extended) of the prescribed motion of the wavemaker as the water moves toward the test specimen.

\begin{figure}[!htb]
 \minipage{0.33\textwidth}
\centering
\minipage{1.01\textwidth}
 \frame{\includegraphics[width=\linewidth]{ExperimentalTestCases/Figure 12a.pdf}}
 \centering
 \\(a) Pre-Impact
\endminipage
\endminipage
\hfill
\minipage{0.3275\textwidth}
\centering
\minipage{1.01\textwidth}
 \frame{\includegraphics[width=\linewidth]{ExperimentalTestCases/Figure 12b.pdf}}
 \centering
 \\(b) Impact
 \endminipage
 \endminipage
 \hfill
 \minipage{0.325\textwidth}
\centering
\minipage{\textwidth}
\centering
  \frame{\includegraphics[width=\linewidth]{ExperimentalTestCases/Figure 12c.pdf}}
  \centering
 \\(c) Post-Impact
 \endminipage
 \endminipage
 \caption{145cm Wave Impact: Comparison}\label{fig:Splash145}

\end{figure}
Side-by-side comparisons of simulation results and videos obtained from experiment trials are depicted in Figs. \ref{fig:Splash145}(a) to \ref{fig:Splash145}(c). General shapes of the free surface of the multi-phase air-water mixture agree well with those observed in videos of the experiments, with a reasonable resolution of the splashing of the fluid around the structure upon impact. As shown in Fig. \ref{fig:Splash145}(c), the experimental and numerical post-impact wake shapes behind the specimen match well.

\indent Experimental time histories of the free-surface height for the wave-gauge instruments as well as the calculated location of the free surface of the simulated fluid air-water boundary at identically located sample points within the computational model are shown for comparison in Fig. \ref{fig:SurfHgt}. 

Comparison between measured values for the free surface and the location of the free surface calculated in OpenFOAM show strong agreement. Velocities for ADVs 1 and 2 match well with velocities calculated in OpenFOAM. ADVs 3 and 4 experienced a large degree of noise from bubbles being created and collapsing, producing acoustic waves, and the broken wave bore near the test structure. A comparison of ADV 3 with its associated OpenFOAM velocity probe are shown in Fig. \ref{fig:ADVVel}, in which the substantial amounts of noise for ADV 3's measured values are shown. 

\begin{figure}[!htb]
  \includegraphics[width=\linewidth]{ExperimentalTestCases/Figure 13.pdf}
  \centering
\caption{Test-Simulation Free Surface Height Comparison - 145cm Wave}\label{fig:SurfHgt}
\end{figure}

\begin{figure}[!htb]
 \includegraphics[width=\linewidth]{ExperimentalTestCases/Figure 14.pdf}
  \centering
\caption{Test-Simulation Velocity Comparison - 145cm Wave}\label{fig:ADVVel}
\end{figure}

\\
\indent Contour plots of the pressure over the upstream face of the specimen obtained from OpenFOAM simulations and experiments at the instant the peak base shear occurred are shown in Fig. \ref{fig:Impact Face Pressures}. The experimentally obtained pressures are shown in the right panel - this contour was constructed by reflecting pressure measurements from all pressure sensors about the center-line of the specimen and using a cubic interpolation function between values of pressure at discrete locations. The signal from the pressure sensors utilized in experiments seems to be attenuated around the peak pressure, which manifests as lower overall pressure magnitudes over the upstream face of the specimen at the instant of peak streamwise force. As such, the contours of experimental and simulated pressures do not appear to match very well at the peak force instance, however local pressure sensor location comparisons show reasonable agreement with slight temporal and magnitude variations. \\

\begin{figure}[!htb]
\includegraphics[width=1\linewidth]{ExperimentalTestCases/Figure 16.pdf}
 \caption{Trial Averaged Upstream Face Pressures at Peak Base Shear (Time:9 seconds)}\label{fig:Impact Face Pressures}
\end{figure}

\indent Pressure contours upon the upstream face of the specimen help determine the nature of the instantaneous and sustained loading profiles upon structural elements and walls subject to bore impact and flow entrapment, for which the shape of the loading profile is significant to evaluating the force response of critical structural elements. Locally measured and simulated pressures show strong agreement over the duration of the loading. This also applies to time-integrated pressure values and resultant impulses, particularly near the base of the structure, where cell sizes are smaller than higher up on the wall. Trial averaged pressure and impulse time histories at two representative points along the seaward face of the structure were chosen for comparison of experimentally measured values and those simulated by the numerical model are shown in Figs. \ref{fig:PressuresAndImpulses}(a)-(d). 

\begin{figure}[!h]
\minipage{0.45\textwidth}
\vspace{0pt} \vfill
\\ 
 \includegraphics[width=\linewidth,align=t]{ExperimentalTestCases/B06Pre_145cm_.png}
  \\ \small
  \\ 
 \\(a) Sensor B06 Pressure
 \\
\\
\vspace{0pt}
 \includegraphics[width=\linewidth,align=t]{ExperimentalTestCases/B06Imp_145cm_.png}
  \small
 \\(c) Sensor B06 Time-Integrated Pressure
 \\
\endminipage\minipage{0.45\textwidth}
\vspace{0pt} \vfill
 \includegraphics[width=\linewidth,align=t]{ExperimentalTestCases/D11Pre_145cm_.png}
  \\ \small
  \\ 
 \\(b) Sensor D11 Pressure
 \\
\\
\vspace{0pt}
 \includegraphics[width=\linewidth,align=t]{ExperimentalTestCases/D11Imp_145cm_.png}
  \small
 \\(d) Sensor D11 Time-Integrated Pressure
\endminipage\hfill
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\centering
\caption{Trial Averaged Pressure and Time-Integrated Pressure Time Histories for Two Representative Seaward Face Sensors, B06 and D11}\label{fig:PressuresAndImpulses}
\end{figure}

These sensors, B06 and D11, were located near the center and near the lower right corner of the specimen's upstream face respectively. While pressures match well at at order of magnitude, at the local level the pressure distribution over the face of the specimen could be better resolved temporally and spatially with a finer mesh in the plane perpendicular to the flow of the wave. It is presumed that due to the size of the cells, some averaging is occurring between peaks and troughs in pressures which otherwise would have resulted in a closer match to experimental pressure measurements. For this study the mesh was kept at a moderate level of refinement to keep numerical model run-times within reasonable limits, which was deemed acceptable for the phenomenological purposes of this investigation. 



\subsection{Fluid-Structure-Interaction Analysis}

The case was run first to completion with a CFD-only analysis. To save time, the fields from this analysis were mapped to a FOAMySees FSI model utilizing OpenFOAM's 'mapFields' utility at T=8.75 seconds, shortly after the wave had crested at the flume bathymetry and before it had reached the specimen.


\subsubsection{OpenSees Model Details}

A simplified OpenSees model was built of the concrete core wall specimen, along with the concrete-filled-tubes which supported the core wall. An elastic material with a modulus of elasticity of 5e9 Pascals, density of 2400 $kg/m^3$, and a Poisson ratio of 0.25 was utilized to model the concrete. An 'ElasticMembranePlateSection' with 6 inch thickness was used with 'ShellMITC4' elements roughly 10 cm x 10 cm in size comprising the core wall specimen geometry at the wall and slab centerlines. 
Uni-axial material properties for structural steel ('Steel02' model, with a yield stress of 344.75 MPa, initial elastic tangent of 200 GPa, strain-hardening ratio of 0.1, and isotropic hardening parameters of a1, a2, and a3 of 18.0, 0.925, and 0.15, respectively) and concrete ('Concrete02' model, with concrete compressive strength at 28 days of -49.64 MPa, concrete strain at maximum strength of -0.00326, concrete crushing strength of -9.93 MPa, concrete strain at crushing strength of -0.01631, ratio between unloading slope and initial slope of 0.1, tensile strength of 4.39 MPa, and tension softening stiffness of 2 GPa) respectively were chosen for modelling materials of the CFT tubes within OpenSeePy. Fiber sections with elastic uniaxial materials and 64 fibers each were utilized to represent the composite sections of the columns, which were standard 10.16 cm (4 in) steel pipes with 1.27 cm (1/2 in) thick walls filled with concrete. EqualDOF commands were utilized for connection of structural elements of different formulations within OpenSeesPy. The structure was fixed at its base.

The model was given Rayleigh damping in OpenSeesPy with a value of 7.5 \% from the frequency of the first structural mode ($f_1$) to five times that frequency (5$f_1$) with Rayleigh mass coefficients of $\alpha_{mass} = 0.0$ and Rayleigh stiffness coefficients of $\beta_{tangent} = 0.0, \beta_{initial} = \frac{\zeta*5f_1 - \zeta*f_1}{\pi*(5f_1^2 - f_1^2)},$ and $\beta_{committed}=0.0$.   \\

\subsection{Discussion}
\subsubsection*{Challenges}
Time increments required by the CFD model at the resolution needed to obtain good forces are small. Standard adaptive timestepping to maintain CFL criteria cannot be utilized without modification of the OpenFOAM coupling adapter ('adjustTimeStep' in system/controlDict must be set to 'false'). Since the fluid is incompressible, heavy numerical instabilities could arise without an implicit coupling scheme stabilizing the solution at large timestep sizes or other means to control the work transfer across the coupling interface. Furthermore, the explicit coupling scheme has a hard time converging during later points of the wave impact due to the high frequency interactions between the models and the effects of added mass instabilities in the partitioned coupling. 

A CFD-only simulation takes roughly 14 hours of execution time to propagate the wave for 9 seconds of simulation time to the structure while using adaptive time-stepping to allow the timestep to increase in situations where the CFL number is less than 0.5. If an implicit coupling scheme were utilized at a timestep of 1e-6 seconds (the required timestep to achieve a CFL condition of 0.5 throughout the whole simulation), an FSI analysis would take significant amounts of time. Using an implicit coupling scheme means iterating over the timestep multiple times, which may be costly for large CFD models. If a CFD-only analysis running at timestep increments of 1e-6s takes 1 day to complete, an implicit analysis would take as many days as the duration of the CFD analysis multiplied by the number of iterations required on average for the model to converge. As the timestep is reduced, more high-frequency interactions between the two analyses are captured, and thus more coupling iterations may be required to ensure convergence.

\subsubsection*{Approach}

The OpenFOAM model was progressed in 50 increments of the displacement calculated by OpenSees during the coupling timestep. Using these modifications to the timestepping and time data interpolation of the coupling participants, work across the coupling interface is preserved, and the CFL criterion of the CFD model can be satisfied without the utilization of small coupling timestep sizes. This results in a simulation which is 'tightly-coupled,' but maintains a faster simulation time due to the ability of each solver to utilize the accelerated data from the indirect Quasi-Newton implicit coupling scheme to predict a solution trajectory to the next coupling timestep which results in equivalent amounts of work across the coupling interface after a sufficient number of coupling iterations. For this case, these settings resulted in satisfaction of the residual convergence tolerance fairly quickly. The easing of the temporal work transfer requirements across the interface along with reduction of the number of coupling timesteps and iterations taken along with time-interpolation of data vastly improves numerical solution speeds. This smooths the work transfer functional (See \ref{sec:WorkTransfer}), but if timesteps are small enough to capture the governing physics and forces of the problem of interest while maintaining a reasonable simulation duration then the methodology could possibly be utilized for solutions over larger domains or more quickly than if the timestep were to be kept at the same size for each component analysis. 

\subsubsection{FSI Simulation Results}

As seen in Table \ref{tab:SimExpForce}, with respect to the values for base shear and overturn moment calculated from the strain gauges upon the supporting CFTs and the forces obtained from the numerical model, shear and vertical forces were over-measured by the load cells, but overturn moments were under-measured. This is assumed to be due to the presence of large magnitudes of water near the upstream face of the specimen weighing the panels surrounding the specimen down, and thus imparting the force of its weight on the load cells nearest the front of the structure and reducing their contribution to the overturn moment. This 'floor-loading' phenomena was simulated within OpenFOAM and compared to the measured values from the load cells, seen in the Fz column of Table \ref{tab:SimExpForce}.

\begin{table}[!h]
\centering \small
\caption{1.45 m Wave Force Comparison: Simulated vs. Experimentally Measured}
    \label{tab:SimExpForce}
    \begin{tabular}{|c||c|c|c|c|c|c|}
    
  \hline
&	 	Fx 	&	 	Fy 	&	 	Fz 	&	 	Mx 	&	 	My 	&	 	Mz 	\\
&	$[kN]$	&	 	$[kN]$ 	&	 	$[kN]$ 	&	 	$[kN-m]$ 	&	 	$[kN-m]$ 	&	 	$[kN-m]$ 	\\
  \hline
    \hline
Strain Gauges	&	 	25.74 	&	 	0 	&	 	11.13 	&	 	2.28 	&	 	24.31 	&	 	0.41 	\\
  \hline
Load Cell	&	 	37.62 	&	 	0.61 	&	 	-106.09 	&	 	0.8 	&	 	22.41 	&	 	2.57 	\\
  \hline
Pressure Sensors	&	25.91	&	 0	&	 0	&	 0	&	 	0 	&	 	0 	\\
  \hline
  \hline
OpenFOAM CFD Simulation	&	 	31.79 	&	 	0 	&	 	-111.01	&	 	0 	&	 	22.65 	&	 	0 	\\
  \hline
  
\end{tabular}\\
\\
\hline
\\  
FOAMySees FSI Simulation, OpenFOAM $\delta_t=1e-5$s, Coupling $\delta_t=5e-4$s, IQN-ILS,\\ Coupling Residual $\epsilon_{rel}=5e-3$, Init. Relaxation Factor $\alpha = 0.1$
  
\hline
\\
Time to completion (1 Simulation Second) = 
~ 56 hours (real time), 40 Procs, 1 Node, UW HYAK Klone
\hline
  
  \begin{tabular}{|c||c|c|c|c|c|c|}

  
  \hline
Avg. Max Courant No = 2 &	 	Fx 	&	 	Fy 	&	 	Fz 	&	 	Mx 	&	 	My 	&	 	Mz 	\\
&	$[kN]$	&	 	$[kN]$ 	&	 	$[kN]$ 	&	 	$[kN-m]$ 	&	 	$[kN-m]$ 	&	 	$[kN-m]$ 	\\
  \hline
OpenSees Reaction &	42.445  &  0.30 &   31.35 &   0.11  &  23.19  &   0 \\
  \hline
  \end{tabular}

\hline
\\  
% FOAMySees FSI Simulation, OpenFOAM $\delta_t=1e-6$s, Coupling $\delta_t=5e-4$s, Explicitly-Coupled

% \hline
% \\
% Time to completion (1 Simulation Second) = 
% ~ 40 hours (real time) 40 Procs, 1 Node, UW HYAK Klone
% \hline
% \\
%   \begin{tabular}{|c||c|c|c|c|c|c|}
%   \hline
% Avg. Max Courant No = 0.2 &	 	Fx 	&	 	Fy 	&	 	Fz 	&	 	Mx 	&	 	My 	&	 	Mz 	\\
% &	$[kN]$	&	 	$[kN]$ 	&	 	$[kN]$ 	&	 	$[kN-m]$ 	&	 	$[kN-m]$ 	&	 	$[kN-m]$ 	\\
%   \hline
% OpenSees Reaction &	 33.52  &  0.796  &  20.01 &   0.10 &   13.90 &   10.08 \\

%   \hline
%   \end{tabular}
  
\end{table}

Forces and moments from the CFD simulations slightly vary from those obtained from the experiments, but these force trends and magnitudes fall within 10 percent of the measured loads which are unaffected by slight asymmetries in the test frame's stiffness. These differences are still to be investigated in future research, however the agreement between forces obtained from experiments and numerical models is assumed to be within acceptable ranges for justifying further refinements to the modelling methodologies and advancement of the techniques implemented for tsunami-resilience-engineering purposes. Streamwise forces, overturn moment, and vertical forces from the experiments, CFD models, and FSI models are shown in Figure \ref{fig:OSUX}, Figure \ref{fig:OSUMY}, and Figure \ref{fig:OSUZ}, respectively. The simulation was run first with an implicit coupling scheme, with a coupling relative residual tolerance of 5e-3 and a coupling timestep of 5e-4s. The work input into the OpenSees model for both the implicit and explicit simulation are shown in Figure \ref{fig:OSUWorkIn}. The explicit simulation experiences an instability around the time of maximum force, resulting in large spikes in the resolved forces and large amounts of generated spurious work. The implicit simulation ensures that this work remains bounded through relative convergence of the data within each coupling timestep.
Errors for work transfer across interface with respect to work transfer rate is shown in Figure \ref{fig:OSUWorkRate}. It is expected that with a reduced timestep the work transfer errors which arise from the large coupling timestep size would be minimized - however, reduction of the timestep will increase the probability that the explicitly-coupled simulation will diverge due to the inherent added-mass instabilities of partitioned-explicit coupling. 

\begin{figure}[!htb]
\centering
\includegraphics[width=0.8\linewidth]{Figures/OSUForceCompareX.pdf}
\caption{145cm Wave Impact Forces: Comparison Between Trial Averaged Experimental and Simulated Streamwise Forces. Experimental streamwise forces are measured through load cells, pressure sensors, and strain gauges. Simulated forces were calculated with OpenFOAM and FOAMySees}\label{fig:OSUX}
  
\end{figure}

\begin{figure}[!htb]
\centering
\includegraphics[width=0.75\linewidth]{Figures/OSUForceCompareMY.pdf}
\caption{145cm Wave Impact Forces: Comparison Between Trial Averaged Experimental and Simulated Overturn Moment. Experimental values are measured through load cells and strain gauges. Simulated forces were calculated with OpenFOAM and FOAMySees}\label{fig:OSUMY}
  
\end{figure}

\begin{figure}[!htb]
\centering
\includegraphics[width=0.8\linewidth]{Figures/OSUForceCompareZ.pdf}
\caption{145cm Wave Impact Forces: Comparison Between Trial Averaged Experimental and Simulated Principal Vertical Forces. Simulated forces were calculated with FOAMySees}\label{fig:OSUZ}
  
\end{figure}


\begin{figure}[!htb]
\centering
\includegraphics[width=\linewidth]{Figures/OSUWorkIn.pdf}
\caption{145cm Wave Impact: Explicit and Implicit Work Into OpenSees from OpenFOAM - Explicit Simulation Experienced Instability, Resulting in Large Amounts of Erroneous Work Transferred}\label{fig:OSUWorkIn}
  
\end{figure}


\begin{figure}[!htb]
\centering
\includegraphics[width=\linewidth]{Figures/OSUWorkRateErrors.pdf}
\caption{145cm Wave Impact: Explicit and Implicit Work Errors WRT Work Transfer Rate - Explicit Simulation Experienced Instability, Resulting in Large Amounts of Erroneous Work Transferred, but This Erroneous Work is Transferred Almost Entirely to OpenSees }\label{fig:OSUWorkRate}
  
\end{figure}


OpenFOAM Calculated Free Surface Values 

.. figure:: figures/WaveGauges.png
   :align: center
   :width: 600
   :figclass: align-center
    Wave Gauges




